pipeline {
    agent any
    stages {
         stage('Clean Workspace'){
        steps {
          cleanWs()
          }
      }
        stage ('Checkout') {
            steps {
                checkout scm
              }
            }          

        stage('Version node') {
            steps {
               echo "Version node"
               bat "node -v"
            }
        }
        stage('Install bootstrap') {
            steps {
                echo "install bootstrap"
                bat "npm install -g bootstrap@4.0.0-alpha.6"
            }
        }
        stage('Install Npm') {
            steps {
                bat "npm install -g npm"
                bat "npm -v"
            }
        }
        stage('Automation') {
            node('ts-build') {
            def collectionName = 'postman/test.postman_collection.json'
            docker.image('postman/newman_ubuntu1404').inside("--entrypoint=''"){
            sh "newman run '$collectionName'"
     }
  }
}
//          stage('Install Newman') {
//              steps {
// //                  nodejs(nodeJSInstallationName: 'Node', cacheLocationStrategy: executor()) {
//                     bat "npm install -g newman"
//                     bat "node newman -v"
// //                  }
//             }
//         }
//         stage('Tests') {
//             steps {
//                  echo "Run tests"
// //                                         sh "./node_modules/.bin/nightwatch -e chrome,firefox,ie,edge --test tests/guineaPig.js || true"

//                  bat "node newman run /postman/test.postman_collection.json"
//             }
//         }

    }
}
